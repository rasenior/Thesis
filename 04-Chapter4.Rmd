
```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE,message = FALSE,error = FALSE, warning = FALSE, 
                      fig.width = 16.6/2.54, fig.height = 10/2.54, dpi = 800, 
                      fig.path = "./output/", fig.align = "center")
```

```{r, include = FALSE}

options(scipen = 999)

# Define base directories
user <- Sys.info()[7]

mod_dir <- file.path("data/models")
pred_dir <- file.path("data/predictions")
fig_dir <- file.path("figs")

# Read in model summaries
pca_results <- read.csv(file.path(mod_dir,"pca_summary.csv"))
results <- read.csv(file.path(pred_dir,"results_summary.csv"))
colnames(results)[names(results)=="p.value_cat"]<-"pval"

# Read in plots
fig1 <- readRDS("figs/fig4.1.Rds")
fig2 <- readRDS("figs/fig4.2.Rds")
fig3 <- readRDS("figs/fig4.3.Rds")
fig4 <- readRDS("figs/fig4.4.Rds")
fig5 <- readRDS("figs/fig4.5.Rds")

cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442",
               "#0072B2", "#D55E00", "#CC79A7")

# Read in model summaries
pca_results <- read.csv(file.path(mod_dir,"pca_summary.csv"))
results <- read.csv(file.path(pred_dir,"results_summary.csv"))
colnames(results)[names(results)=="p.value_cat"]<-"pval"

### What were the significant MAIN results?

# Q1a - Does logging affect the relationship between micro- and macroclimate temperature?
# Yes: primary forest associated with steeper slope in deadwood, tree hole and leaf litter microclimates
q1_interaction <- read.csv(file.path(pred_dir,"fig3_sig_interactions.csv"))
q1_deadwood_interaction <- q1_interaction[q1_interaction$microhabitat == "Deadwood",]
q1_hole_interaction <- q1_interaction[q1_interaction$microhabitat == "Tree hole",]
q1_litter_interaction <- q1_interaction[q1_interaction$microhabitat == "Leaf litter",]

# Q1b - Does tree stand basal area affect microclimate temperature?
# Yes: increased tree BA associated with slightly higher micro temp.
q1_hole <- read.csv(file.path(pred_dir,"fig3_sig_effects.csv"))

# Q2 - Does tree stand basal area affect microclimate temperature stability/variation?
# No.

# Q3a - Does tree stand basal area affect thermal niche diversity?
# No.

# Q3b - Does tree stand basal area affect the area of surface microclimates?
# No.

# Q3b - Does tree stand basal area affect the AI of surface microclimates?
# No.

# Q3c - Does tree stand basal area affect the volume of microhabitats?
# Yes: more leaf litter in forests with higher BA.
q3_litter_vol_sig <- read.csv(file.path(pred_dir,"fig5_sig_effects.csv"))
q3_patch_range <- read.csv(file.path(pred_dir,"fig5a.csv"))
q3_patch_area <- read.csv(file.path(pred_dir,"fig5b.csv"))
q3_patch_AI <- read.csv(file.path(pred_dir,"fig5c.csv"))
q3_deadwood_vol <- read.csv(file.path(pred_dir,"fig5d.csv"))
q3_hole_vol <- read.csv(file.path(pred_dir,"fig5e.csv"))
q3_litter_vol <- read.csv(file.path(pred_dir,"fig5f.csv"))

### What were the significant SOM results?

# QS2 - Does logging affect forest structure variables: PC1, PC2, tree stand basal area, sapling stand basal area, proportion of trees that are dipterocarps, percentage canopy cover and percentage vegetation cover at ground, understorey and canopy strata?
# Yes: 
# PC1, tree stand basal area, % understorey veg. and % canopy veg. are all higher in primary forest. 
# PC2 and sapling stand basal area are higher in logged forest.
qs2_pc1 <- read.csv(file.path(pred_dir,"figS2a.csv"))
qs2_pc2 <- read.csv(file.path(pred_dir,"figS2b.csv"))
qs2_tree_stand_BA <- read.csv(file.path(pred_dir,"figS2d.csv"))
qs2_saplingBA <- read.csv(file.path(pred_dir,"figS2e.csv"))
qs2_tree_stand_BA_cv <- read.csv(file.path(pred_dir,"figS2f.csv"))
qs2_underVeg <- read.csv(file.path(pred_dir,"figS2_bottom.csv"))
qs2_underVeg <- qs2_underVeg[qs2_underVeg$stratum == "Understorey",]
qs2_canopyVeg <- read.csv(file.path(pred_dir,"figS2_bottom.csv"))
qs2_canopyVeg <- qs2_canopyVeg[qs2_canopyVeg$stratum == "Canopy",]

# QS3 - Does tree stand basal area affect macroclimate temperature and Vapour Pressure Deficit?
# No.

# QS4 - Does logging affect the relationship between micro- and macroclimate temperature during day vs. night?

# Yes: primary forest associated with steeper slope during day in tree holes and leaf litter... 
qs4 <- read.csv(file.path(pred_dir,"figS4_sig_interactions.csv"))
qs4_hole_interaction_day <- qs4[qs4$microhabitat == "Tree hole" & qs4$day_night=="day",]
qs4_litter_interaction_day <- qs4[qs4$microhabitat == "Leaf litter" & qs4$day_night=="day",]

# Yes: primary forest associated with steeper slope during night in deadwood and leaf litter... 
qs4_deadwood_interaction_night <- qs4[qs4$microhabitat == "Deadwood" & qs4$day_night=="night",]
qs4_litter_interaction_night <- qs4[qs4$microhabitat == "Leaf litter" & qs4$day_night=="night",]

# QS4 - Does tree stand basal area affect the microclimate temperature, both during the day and the night?
# Yes. During the day microclimate temperature inside tree holes is higher in logged forest but also slightly increases with
# increasing basal area :/
qs4_hole <- read.csv(file.path(pred_dir,"figS4_sig_effects.csv"))
```

# Tropical forests are thermally buffered despite intensive selective logging

\begin{figure}[!htb]
\centering
\includegraphics[width=15cm]{pics/Bornean_tree_hole_frog.jpg}
\caption*{Bornean tree hole frog (\textit{Metaphrynella sundana}).}
\end{figure}

\pagebreak

## Abstract

Tropical rainforests are subject to extensive degradation by commercial selective logging. Despite pervasive changes to forest structure, selectively logged forests represent vital refugia for global biodiversity. The ability of these forests to buffer temperature-sensitive species from climate warming will be an important determinant of their future conservation value, although this topic remains largely unexplored. Thermal buffering potential is broadly determined by: (1) the difference between the 'macroclimate' (climate at a local scale, m to ha) and the 'microclimate' (climate at a fine-scale, mm to m, that is distinct from the macroclimate); (2) thermal stability of microclimates (e.g. variation in daily temperatures); and (3) the availability of microclimates to organisms. We compared these metrics in undisturbed primary forest and intensively logged forest on Borneo, using thermal images to capture cool microclimates on the surface of the forest floor, and information from dataloggers placed inside deadwood, tree holes and leaf litter. Although major differences in forest structure remained 9-12 years after repeated selective logging, we found that logging activity had very little effect on thermal buffering, in terms of macroclimate and microclimate temperatures, and the overall availability of microclimates. For 1&deg;C warming in the macroclimate, temperature inside deadwood, tree holes and leaf litter warmed slightly more in primary forest than in logged forest, but the effect amounted to less than 0.1&deg;C difference between forest types. We therefore conclude that selectively logged forests are similar to primary forests in their potential for thermal buffering, and subsequent ability to retain temperature-sensitive species under climate change. Selectively logged forests can play a crucial role in the long-term maintenance of global biodiversity.

## Introduction

Land-use change is a profound threat to Earth's terrestrial biodiversity [@sala_global2000; @maxwell_biodiversity:2016]. Most of this biodiversity is found in tropical regions [@jenkins_global2013], where rates of deforestation and forest degradation are among the highest globally [@hansen_high-resolution2013]. The detrimental impacts of deforestation on tropical biodiversity are well known [@gibson_primary2011; @barlow_anthropogenic2016]; however, tropical forest degradation via commercial selective logging is 20 times more widespread than on-going conversion [@hansen_humid2008; @asner_contemporary2009], making it important to understand the value of these disturbed forests for biodiversity. Selectively logged forests constitute a large and effective refuge for species of conservation concern that cannot survive in deforested land [@edwards_degraded2011; @gibson_primary2011; @edwards_biodiversity2013]. Protecting selectively logged forests may be a cost effective way to retain tropical biodiversity [@edwards_maintaining2014], but this is heavily contingent on the assumption that these forests will maintain their current conservation value into the future. 

Several factors may influence the value of selectively logged forests for biodiversity in the long-term, and a key consideration is the interaction of multiple drivers of biodiversity loss [@brook_synergies2008; @mantyka-pringle_interactions2012; @sirami_impacts2017]. The impacts of climate change are particularly important, and increasingly so as this century progresses [@sala_global2000; @chou_increase2013; @ipcc_climate2013]. Novel (non-analogous) climatic conditions are predicted to appear first in the tropics [@mora_projected2013], where many species have narrow thermal limits [@deutsch_impacts2008; @tewksbury_putting2008; @khaliq_global2014] and where there is limited dispersal potential owing to poor dispersal ability of many species [@van_houtan_dispersal2007]. This vulnerability of tropical species is compounded by an absence of target habitats containing analogous climates [@colwell_global2008], and widespread deforestation creating a hostile matrix through which dispersal must occur [@brook_synergies2008; @scriven_protected2015]. The ability of tropical species to withstand climate change, and so avoid extinction, is likely to be highly dependent on their ability to adapt *in situ* within existing forest areas. The extent to which species persistence can be facilitated within selectively logged forests will, therefore, greatly influence the conservation value of these habitats. 

In primary forests and secondary forests re-growing on abandoned farmland, previous studies found that organisms â€“ particularly ectotherms â€“ avoid suboptimal temperatures in the wider 'macroclimate' (climate at a spatial scale of m to ha) by moving locally into 'microclimates': climate at a fine-scale, mm to m, that is distinct from the macroclimate [@scheffers_microhabitats2014-1;  @scheffers_microhabitats2014; @gonzalez_del_pliego_thermally2016]. Climate at this fine-scale is more relevant for the majority of terrestrial biodiversity, which primarily consists of small-bodied ectotherms [@suggitt_habitat2011; @potter_microclimatic2013; @nadeau_coarse2017]. Indeed, the vast proportion of terrestrial species are small in size, flat in shape, or thermoregulate via contact with vegetation, and so it is important to consider microclimates close to, and including, the surfaces on which these species live [@kaspari_thermal2015; @scheffers_extreme2017]. 

The most informative fine-scale temperature data are derived from point measurements that are highly replicated in both space and time, and demonstrate that loss of vegetation cover causes local daytime warming [@senior_pantropical2017; @ewers_fragmentation2013; @hardwick_relationship2015; @gonzalez_del_pliego_thermally2016]. Selective logging affects vegetation by lowering and thinning the canopy, reducing leaf area index [@hardwick_relationship2015; @ewers_logging2015] and the number of vegetation strata, and creating large forest gaps [@okuda_effect2003; @kumar_effects2005]. As such, the understorey of logged forests likely receives a greater amount of solar radiation, partitioned increasingly as direct rather than diffuse radiation [@oke_boundary1987], although these impacts diminish rapidly as selectively logged forests recover [@asner_canopy2004]. The most tangible impact on the local climate could be an overall increase in the day-time temperature of logged forests, increasing the necessity for thermal buffering. Simultaneously, the potential for thermal buffering may be compromised if forest structural changes also influence the temperature and distribution of cool microclimates, particularly if their temperature becomes more similar to that of the wider macroclimate [e.g. @caillon_warming2014], or there are simply fewer cool microclimates available overall. Conversely, enhanced air-mixing in more open logged forests might create cooler and less variable microclimates. Previous evidence suggests that the availability of cool 'microhabitats' [localised environments within which cool microclimates are contained; @scheffers_microhabitats2014-1; @gonzalez_del_pliego_thermally2016; @shi_framework2016] can be reduced [e.g., leaf litter; @saner_reduced2009] or increased [e.g., deadwood; @carlson_deadwood2017] by selective logging, implying that forest quality alters thermal environments. 

A key novel question that we address in this paper is whether vegetation changes following commercial selective logging reduce the potential for thermal buffering. We focused on cool microclimates in the understorey only (climate at mm to m scale that is cooler than the macroclimate and located within ~2 m of the forest floor). Microclimates on the surface of the forest floor were captured by a thermal camera, while dataloggers were used to capture microclimates within cool understorey microhabitats: leaf litter, tree holes and deadwood [@scheffers_microhabitats2014-1;  @scheffers_microhabitats2014; @gonzalez_del_pliego_thermally2016]. We determined thermal buffering potential according to: (1) the microclimate temperature relative to that of the macroclimate; (2) the daily variation in microclimate temperature; and (3) the availability of microclimates in space. The first two are roughly measures of microclimate 'quality' â€“ they examine how effectively an organism will be buffered from macroclimate warming, assuming it moves into the microclimate. The third captures the likelihood that organisms can locate and move into suitable microclimates, according to the occurrence, distribution and thermal diversity of microclimates within the habitat [@sears_world2011; @caillon_warming2014]. We predicted that logged forests would be structurally distinct from primary forest, and we tested the hypothesis that this would lead to reduced thermal buffering potential and, subsequently, impaired ability of temperature-sensitive species to respond *in situ* to excessively high temperatures in the wider macroclimate.

## Materials and Methods
### Study area

Sampling took place in in an extensive area of contiguous forest in Sabah (Malaysian Borneo; Fig. 1a). This area represents over 10,000 km^2^ of lowland dipterocarp forest, comprising production forest and areas of undisturbed protected forest [@reynolds_changes2011]. In this study, we sampled sites in forest that had been commercially selectively logged twice (Ulu Segama-Malua Forest Reserve, 4&deg;57&rsquo;42.8&rdquo;N, 117&deg;56&rsquo;51.7&rdquo;E). The area was first logged from 1987-1991, using tractors and high-lead extraction techniques to harvest commercial trees (those in the family Dipterocarpaceae) with stems > 0.6 m diameter at breast height (D.B.H.), and yielding ~113 m^3^ of timber per hectare [@fisher_cost-effective2011; @edwards_selective-logging2014]. Between 2001 and 2007, the area was re-logged and the minimum harvested tree diameter reduced to > 0.4 m D.B.H., yielding an additional 31 m^3^/ha of timber [@fisher_cost-effective2011]. Thus, we sampled sites that had been heavily disturbed about 10 years prior to the study, at which point 67% of the forest had an average density of < 10 trees per hectare with a D.B.H. greater than 40 cm [@reynolds_changes2011]. The area has been recovering naturally since logging operations ceased. Control sites were located in undisturbed, protected primary forest (Danum Valley Conservation Area; 4&deg;57&rsquo;45.2&rdquo;N, 117&deg;48&rsquo;10.4&rdquo;E).

```{r fig-4-1, fig.cap= "Study location in Malaysian Borneo (a), and distribution of sites (b): six sites in primary forest (blue) and six sites in logged forest (orange). Each site comprised five plots along an existing transect, with plot centres separated by 125 m (c). Tree and sapling stand basal area was calculated from the distance to and circumference of the nearest two trees and saplings in each of four quadrants centred on the plot centre (d; see Supplementary Text S1 for more details). Curved arrows indicate the direction of magnification, from panels a-d."}
fig1

```

### Sampling design

We sampled twelve sites, six in twice-logged forest and six in primary forest, along existing transects [Fig. 1b; @edwards_degraded2011; @edwards_selective-logging2014]. Sites were more than 2 km apart, and at least 100 m from forest edges. Within each site, we established five plots 50 m in diameter, with plot centres spaced at 125 m intervals along the transect (Fig. 1c; 60 plots in total). Fieldwork was conducted from April to July 2015, during the severe El Ni&ntilde;o-Southern Oscillation (ENSO) event of 2015-2016 [@noaa2015] when mean daily temperature was `r signif(2.264749,3)`&deg;C higher and mean daily rainfall was `r signif(2.08744, 3)` mm lower than the 5-year average (across April to July for the years 2007 to 2011; data from weather station at Danum Valley Field Centre). 

#### Forest structure {-}

To quantify the level of disturbance to the forest from selective logging, we used an established methodology for assessing forest structure in each plot [@hamer_ecology2003; @lucey_spillover2012]. The variables we measured were: the stand basal area (m^2^/ha) of mature trees (circumference > 0.6 m) and saplings (circumference 0.1-0.6 m), based on the distance to and circumference at breast height of the two nearest trees and saplings in each of four quadrants centred on the plot centre (Fig. 1d); the coefficient of variation for the basal area of trees and of saplings; the proportion of mature trees that were dipterocarps (indicative of mature, complex forest); percentage canopy cover; and visual estimates of percentage vegetation cover at ground (1.5 m above ground), understorey (15 m above ground) and canopy (the main stratum of leaf cover > 15 m above ground) height. For full methodological details see Supplementary Text S1.

#### Quantifying surface microclimates {-}

Fine-scale surface temperature of the forest floor is particularly relevant for small-bodied, surface-dwelling organisms, such as many insect and reptile species. We measured surface temperature within each plot using an infrared camera (FLIR Systems, model E40). Macroclimate temperature was defined as the air temperature at 1.5 m above-ground, measured using a whirling hygrometer. Each site was visited on two days, and each plot within the site was sampled five times each day between 05:00 hrs to 14:30 hrs. During each sample of any given plot, the observer stood at the centre of the plot, took a single hygrometer reading and then, holding the camera at breast height and pointing 45&deg; downwards (relative to the ground), took a photo in four orthogonal directions [@scheffers_extreme2017]. Each thermal image comprised 19200 distinct observations of surface temperature (one per pixel), and covered a surface area of approximately 1 m^2^. In total, we recorded 2400 thermal images (4 images per plot x 5 repeats x 2 site visits x 60 plots). 

For all subsequent analyses, a unique data point comprised thermal information from the four photographs taken each time a plot was sampled: 76800 observations of surface temperature measurements for each plot (i.e. combining 19200 observations from the four photos taken in each orthogonal direction). For details of thermal image data extraction and processing see Supplementary Text S2. The temperature of cool surface microclimates was defined as the 5^th^ percentile (i.e. coolest) across all 76800 pixels. For some organisms, the efficacy of thermal buffering also depends on the thermal stability of microclimates [@shi_framework2016]. We calculated daily variation in surface microclimate temperature as the difference between the minimum and maximum microclimate temperature, for each day and for each plot.

To identify spatially-explicit patches of warm and cool pixels (Fig. 2) we calculated the Getis-Ord local statistic for each pixel within the neighbourhood of the nearest eight pixels, using the function 'localG' in the spdep package in R [@bivand_comparing2015; @r_core_team_r:2017]. Pixels with a Z-value of &ge; 3.886 were defined as being within warm patches, and those with a Z-value of &le; -3.886 within cool patches [@getis_local1996]. Thermal diversity was defined as the difference between the median temperature of the warmest warm patch minus the median temperature of the coolest cool patch (hereafter: 'patch temperature range'). The average surface area of cool patches was calculated as the total number of pixels within cool patches, multiplied by the surface area of one pixel (`r signif((110*90)/19200,3)` cm^2^), and divided by the total number of cool patches across the four photos. Finally, spatial configuration of cool patches was quantified using the Aggregation Index: the number of edges that cool patches share, divided by the maximum number of edges that they could possibly share [@he_aggregation2000; @caillon_warming2014]. Higher values of the Aggregation Index indicate increased clustering of microclimates in space, which makes them more difficult for organisms to track [@sears_configuration2016].

```{r fig-4-2, fig.cap= "Example thermal image. Pixels are shaded from cold (purple) to hot (yellow). Warm patches (outlined in pink) and cool patches (outlined in blue) were identified using the Getis-Ord local statistic of each pixel.", fig.width = 8/2.54, fig.height=9/2.54}
fig2

```

#### Quantifying microclimates in leaf litter, tree holes and deadwood {-}

Many ectotherms, such as amphibians, spend some or all of their time exploiting cool microclimates inside microhabitats, which thermal images are unable to capture. We selected three types of microhabitat known to provide cool microclimates [@scheffers_microhabitats2014; @scheffers_microhabitats2014-1; @gonzalez_del_pliego_thermally2016], and placed one temperature datalogger (HOBO pendant datalogger, Onset, model UA-001-64K or model UA-002-64K) per plot in each microhabitat type: deadwood (> 10 cm stem diameter), tree holes (> 2 cm at widest point of entrance hole, < 2 m above the ground) and leaf litter (1.5 m left of the plot centre). The hygrometer measurements of macroclimate temperature were not always synchronised with the dataloggers inside microhabitats, hence we additionally measured macroclimate temperature using a datalogger suspended 1.5 m above the ground at the centre of each plot, shielded against direct radiation and precipitation by an inverted plastic funnel [@shoo_potential2010; @scheffers_microhabitats2014-1]. 

All dataloggers recorded temperature every 20 minutes for six consecutive days, occurring within one week of thermal image collection. For qualitative comparison with thermal images and to lessen the degree of temporal autocorrelation, microclimate temperatures for each of the three microhabitats in each plot were calculated as the median of six daily measures, computed for each two-hour interval during the same time period as when thermal images were collected (i.e. 04:40 to 14:40 hrs). Our analyses focused on day-time thermal buffering, but we also ran analogous models for the full 24 hours to explore night-time thermal buffering (see Supplementary Text S5). In the main text, we only present data for day-time measurements because this is most relevant to organisms seeking to avoid extremes of heat, and because findings were qualitatively similar. Variation in temperature for microclimates inside microhabitats was defined as the daily range (95^th^ percentile minus 5^th^ percentile) of raw temperatures for each day, in each plot. 

To estimate the occurrence of microclimates inside microhabitats, we measured the volume of leaf litter, tree holes and deadwood within a 50 x 5 m subplot centred on each plot centre (60 sub-plots in total), with the long edge running parallel to the transect. For full methodological details see Supplementary Text S3. We divided microhabitat volume by the total area surveyed to generate microhabitat volume per m^2^ forest, for each plot. 

### Variables analysed

#### Forest structure {-}

We examined the impact of selective logging on forest structure using linear mixed effects models to compare nine structural response variables between logged and primary forests: stand basal area of trees and of saplings; the coefficient of variation across individual basal areas of trees and of saplings; proportion of trees that were dipterocarps (binomial data: dipterocarp versus non-dipterocarp); percentage canopy cover (proportion data); and percentage vegetation cover at ground, understorey and canopy strata (proportion data). We found that tree stand basal area (m^2^/ha) was a good measure of changes in forest structure from logging activity (LR = `r round(results$test_stat[results$Q == "QS2c_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2c_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2c_forest_type"][2]`; see Results for full details), hence we use this variable as a continuous measure of disturbance (henceforth: forest quality) in all our analyses exploring the thermal buffering potential of logged and unlogged forests.

#### Macroclimate and microclimate temperature {-}

Macroclimate temperature is the temperature at a relatively coarse spatial scale, and was captured in this study using both a hygrometer and suspended datalogger (measuring the same variable but at different times). The macroclimate does not affect thermal buffering potential *per se*, but it does dictate the overall necessity for thermal buffering. We modelled hygrometer and datalogger temperature separately, including forest type (logged or primary forest) and forest quality as explanatory variables (see Supplementary Text S4). 

To assess the impact of selective logging on the ability of microclimates to buffer organisms from macroclimate warming, we modelled microclimate temperature against forest quality, forest type and macroclimate temperature, including an interaction term between the latter two variables. The slope of the relationship between microclimate and macroclimate temperature is a measure of the rate of change. Surface microclimate temperature refers to the 5^th^ percentile of surface temperature observations  (i.e. coolest) for each plot, and this was compared against macroclimate temperature as measured by the hygrometer. Microclimate temperature inside leaf litter, tree holes and deadwood refers to the two-hourly median temperature recorded by dataloggers inside microhabitats, and this was compared against macroclimate temperature as measured by a suspended datalogger. 

To capture the impact of logging on the thermal stability of microclimates, we modelled microclimate temperature range against forest type and forest quality. For surface microclimates, the range was the daily range of surface temperature observations (the 5^th^ percentiles, i.e. coolest surface temperatures). For microclimates inside microhabitats, the range was the daily range (95^th^ percentile minus 5^th^ percentile) of the raw temperature observations. All models were run separately for surface, leaf litter, tree hole and deadwood microclimates. 

#### Microclimate availability {-}

Microclimate occurrence was modelled separately for surface microclimates (i.e. the average surface area of cool patches), and those inside leaf litter, tree holes and deadwood (each quantified by their average volume per m^2^ forest). The thermal diversity of surface microclimates was captured by the temperature range between the warmest warm patch and the coolest cool patch. The spatial configuration of surface microclimates refers to the Aggregation Index of cool patches (binomial data: edges shared by cool patches versus edges not shared by cool patches). For all models, the fixed effects were forest type (logged or primary forest) and forest quality (i.e. tree stand basal area). 

### Statistical analyses

All data were analysed using mixed effects models in R [version 3.3.0; @r_core_team_r:2017]. To account for spatial pseudoreplication, forest structure models included 'site' as a random intercept term, and all other models included 'plot' nested within 'site'. Temperature data were recorded at multiple time points, hence the full models were visually assessed for evidence of temporal autocorrelation of residuals [function 'acf' in the nlme package; @pinheiro_nlme:2017], and a correlation structure for both date and time was incorporated where necessary [the specific structure was chosen using AIC; @zuur_mixed2009]. For binomial data (proportion of dipterocarps and surface microclimate Aggregation Index) we used generalized linear mixed effects models (GLMMs) with a binomial error distribution, fitted using the package lme4 [@bates_fitting2015] and tested for overdispersion. Diagnostic plots were assessed for all models to confirm model fit and, where necessary, we modified the variance structure of the residuals [@zuur_mixed2009] and transformed variables to normality. For true proportion data (percentage canopy cover and percentage vegetation cover), the transformation used was a modification of the empirical logit [@warton_arcsine2011].

For all models, statistical significance was inspected using likelihood ratio tests, dropping each fixed effect in turn and comparing it to the full model [@zuur_mixed2009]. The significance of main effects involved in an interaction was assessed in the same way, except reduced models were compared to a full model without the interaction term. The basic structure for most response variables (RV) was:

`RV ~ forest_type + forest_quality + (1|transect/plot) + cor(~ date_time|transect/plot)`

## Results

### Changes in forest structure after logging

Following two rounds of commercial selective logging, tree stand basal area -- our measure of forest quality -- was `r signif(qs2_tree_stand_BA$tree_stand_BA[2],3)` m^2^/ha in logged forest, compared to `r signif(qs2_tree_stand_BA$tree_stand_BA[1],3)` m^2^/ha in primary forest (LR = `r round(results$test_stat[results$Q == "QS2c_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2c_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2c_forest_type"][2]`). Logged forests thus contained far fewer large trees than did primary forests. There were also more large saplings in logged forest (`r signif(qs2_saplingBA$sapling_stand_BA[2],3)` m^2^/ha) than in primary forests (`r signif(qs2_saplingBA$sapling_stand_BA[1],3)` m^2^/ha; LR = `r round(results$test_stat[results$Q == "QS2d_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2d_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2d_forest_type"][2]`), and trees were less variable in size (LR = `r round(results$test_stat[results$Q == "QS2e_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2e_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2e_forest_type"][2]`). There was no difference between forest types in terms of the variability of size among saplings (LR = `r round(results$test_stat[results$Q == "QS2f_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2f_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2f_forest_type"][2]`).

Changes to forest structure from selective logging were also evident in the overall amount of vegetation cover. Although there was no observed difference between logged forest and primary forest in percentage vegetation at ground level (LR = `r round(results$test_stat[results$Q == "QS2i_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2i_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2i_forest_type"][2]`), the proportion of trees that were dipterocarps (`r paste("\U03A7","\U00B2",sep="")` = `r round(results$test_stat[results$Q == "QS2g_forest_type"][1],3)`, *P* `r results$pval[results$Q == "QS2g_forest_type"][1]`; `r results$fig_ref[results$Q == "QS2g_forest_type"][1]`) or the percentage canopy cover (LR = `r round(results$test_stat[results$Q == "QS2h_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2h_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2h_forest_type"][2]`), we did find that percentage vegetation cover was higher in primary forest than in logged forest in both the understorey (primary = `r signif(qs2_underVeg$veg_cover[1],3)`%; logged = `r signif(qs2_underVeg$veg_cover[2],3)`%; LR = `r round(results$test_stat[results$Q == "QS2j_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2j_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2j_forest_type"][2]`), and in the canopy (primary = `r signif(qs2_canopyVeg$veg_cover[1],3)`%; logged = `r signif(qs2_canopyVeg$veg_cover[2],3)`%; LR = `r round(results$test_stat[results$Q == "QS2k_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS2k_forest_type"][2]`; `r results$fig_ref[results$Q == "QS2k_forest_type"][2]`). Thus, 9-12 years after logging there were significant differences in forest structure between logged and primary forests. This was especially true for the components of forest structure that typically indicate the presence of large, mature trees and high structural complexity, and which might be expected to influence microclimates and the availability of microhabitats.

### Macroclimate and microclimate temperature in logged and primary forest

Despite differences in forest structure, we found no difference in macroclimate temperature of logged and primary forests, whether measured by the hygrometer (LR = `r round(results$test_stat[results$Q == "QS3a_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS3a_forest_type"][2]`; `r results$fig_ref[results$Q == "QS3a_forest_type"][2]`) or suspended datalogger (LR = `r round(results$test_stat[results$Q == "QS3b_forest_type"][2],3)`, *P* `r results$pval[results$Q == "QS3b_forest_type"][2]`; `r results$fig_ref[results$Q == "QS3b_forest_type"][2]`). Macroclimate temperature was also consistent across varying levels of forest quality, for temperature measured via the hygrometer (LR = `r round(results$test_stat[results$Q == "QS3a_tree_stand_BA"][2],3)`, *P* `r results$pval[results$Q == "QS3a_tree_stand_BA"][2]`; `r results$fig_ref[results$Q == "QS3a_tree_stand_BA"][2]`) and suspended datalogger (LR = `r round(results$test_stat[results$Q == "QS3b_tree_stand_BA"][2],3)`, *P* `r results$pval[results$Q == "QS3b_tree_stand_BA"][2]`; `r results$fig_ref[results$Q == "QS3b_tree_stand_BA"][2]`). Thus, the necessity for thermal buffering was comparable between the two forest types.

Absolute microclimate temperature was comparable between forest types for all of the microclimates considered: surface (LR = `r round(results$test_stat[results$Q == "Q1a_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q1a_forest_type"][2]`; `r results$fig_ref[results$Q == "Q1a_forest_type"][2]`), deadwood (LR = `r round(results$test_stat[results$Q == "Q1b_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q1b_forest_type"][2]`; `r results$fig_ref[results$Q == "Q1b_forest_type"][2]`), tree holes (LR = `r round(results$test_stat[results$Q == "Q1c_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q1c_forest_type"][2]`; `r results$fig_ref[results$Q == "Q1c_forest_type"][2]`) and leaf litter (LR = `r round(results$test_stat[results$Q == "Q1d_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q1d_forest_type"][2]`; `r results$fig_ref[results$Q == "Q1d_forest_type"][2]`). We found that the relationship between microclimate temperature and macroclimate temperature was slightly steeper in primary forest compared to logged forest for deadwood (LR = `r round(results$test_stat[results$Q == "Q1b_interaction"][2],3)`, *P* `r results$pval[results$Q == "Q1b_interaction"][2]`; `r results$fig_ref[results$Q == "Q1b_interaction"][2]`), tree holes (LR = `r round(results$test_stat[results$Q == "Q1c_interaction"][2],3)`, *P* `r results$pval[results$Q == "Q1c_interaction"][2]`; `r results$fig_ref[results$Q == "Q1c_interaction"][2]`) and leaf litter (LR = `r round(results$test_stat[results$Q == "Q1d_interaction"][2],3)`, *P* `r results$pval[results$Q == "Q1d_interaction"][2]`; `r results$fig_ref[results$Q == "Q1d_interaction"][2]`). However, for 1&deg;C macroclimate warming (from the median value) the maximum difference in microclimate warming between forest types was < 0.1&deg;C, and no such interaction was apparent for surface microclimates (LR = `r round(results$test_stat[results$Q == "Q1a_interaction"][2],3)`, *P* `r results$pval[results$Q == "Q1a_interaction"][2]`; `r results$fig_ref[results$Q == "Q1a_interaction"][2]`). Similarly, for a 1 m^2^/ha increase in forest quality (i.e. tree stand basal area), tree hole temperature was slightly warmer (LR = `r round(results$test_stat[results$Q == "Q1c_tree_stand_BA"][2],3)`, *P* `r results$pval[results$Q == "Q1c_tree_stand_BA"][2]`; `r results$fig_ref[results$Q == "Q1c_tree_stand_BA"][2]`), but the size of this effect was negligible (+`r signif(q1_hole$micro_diff[1],3)`&deg;C), and not evident for other microclimates (*P* > 0.05; Fig. 3e-h). Thus we conclude that effects of logging on microclimate temperature were generally not evident, or minimal.

The final facet of microclimate temperature that we considered was daily temperature variation. This too was comparable between logged and primary forests for microclimates at the surface (LR = `r round(results$test_stat[results$Q == "Q2a_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q2a_forest_type"][2]`; `r results$fig_ref[results$Q == "Q2a_forest_type"][2]`), as well as those inside deadwood (LR = `r round(results$test_stat[results$Q == "Q2b_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q2b_forest_type"][2]`; `r results$fig_ref[results$Q == "Q2b_forest_type"][2]`), tree holes (LR = `r round(results$test_stat[results$Q == "Q2c_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q2c_forest_type"][2]`; `r results$fig_ref[results$Q == "Q2c_forest_type"][2]`) and leaf litter (LR = `r round(results$test_stat[results$Q == "Q2d_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q2d_forest_type"][2]`; `r results$fig_ref[results$Q == "Q2d_forest_type"][2]`). Microclimate temperature variation was also consistent across different levels of forest quality (*P* > 0.05; Fig. 4).

In summary, selective logging had little observed impact on absolute microclimate temperature or its daily variation. There was some evidence that thermal buffering potential was slightly enhanced for deadwood, tree holes and leaf litter inside logged forest, but the effects were extremely small and not evident for microclimates at the surface.

```{r fig-4-3}
fig3

```

"Comparison between primary forest (blue) and logged forest (orange) in terms of: (a-d) the relationship between microclimate temperature and macroclimate temperature; and (e-h) absolute microclimate temperature across varying levels of forest quality (measured as tree stand basal area). Microclimates were measured at the surface (a, e), and inside deadwood (b, f), tree holes (c, g)  and leaf litter (d, h). The grey dashed lines in panels a-d indicate zero temperature buffering, where the microclimate temperature is equal to the macroclimate temperature. In all panels, shaded bands are 95% confidence intervals."

```{r fig-4-4, fig.height = 6.5/2.54}
fig4

```

"The influence of forest type (primary or logged) and forest quality (measured as tree stand basal area) on microclimate temperature range. Daily range for surface microclimates (a) was calculated as the difference between the maximum and the minimum microclimate temperature (itself calculated as the 5^th^ percentile temperature across four photos taken at each visit to each plot). For microclimates inside deadwood (b), tree holes (c) and leaf litter (d), the daily range was the difference between the 95^th^ percentile and 5^th^ percentile of raw temperature measurements. Primary forest data points are depicted as blue circles and logged forest as orange triangles. Shaded bands represent 95% confidence intervals."

### Microclimate availability in logged and primary forest

The thermal buffering potential within a habitat depends not only on the temperature of microclimates relative to the macroclimate, but also on the overall availability and thermal diversity of those microclimates. The occurrence of surface microclimates was not impacted by forest type (LR = `r round(results$test_stat[results$Q == "Q3b_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q3b_forest_type"][2]`; `r results$fig_ref[results$Q == "Q3b_forest_type"][2]`), and the average volume of microhabitats (per m^2^ forest) was similar in logged and primary forest for deadwood (LR = `r round(results$test_stat[results$Q == "Q3d_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q3d_forest_type"][2]`; `r results$fig_ref[results$Q == "Q3d_forest_type"][2]`), tree holes (LR = `r round(results$test_stat[results$Q == "Q3e_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q3e_forest_type"][2]`; `r results$fig_ref[results$Q == "Q3e_forest_type"][2]`) and leaf litter (LR = `r round(results$test_stat[results$Q == "Q3f_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q3f_forest_type"][2]`; `r results$fig_ref[results$Q == "Q3f_forest_type"][2]`). There was no observed impact of forest quality on the occurrence of surface microclimates (LR = `r round(results$test_stat[results$Q == "Q3b_tree_stand_BA"][2],3)`, *P* `r results$pval[results$Q == "Q3b_tree_stand_BA"][2]`; `r results$fig_ref[results$Q == "Q3b_tree_stand_BA"][2]`) or the volume of deadwood (LR = `r round(results$test_stat[results$Q == "Q3d_tree_stand_BA"][2],3)`, *P* `r results$pval[results$Q == "Q3d_tree_stand_BA"][2]`; `r results$fig_ref[results$Q == "Q3d_tree_stand_BA"][2]`) and tree holes (LR = `r round(results$test_stat[results$Q == "Q3e_tree_stand_BA"][2],3)`, *P* `r results$pval[results$Q == "Q3e_tree_stand_BA"][2]`; `r results$fig_ref[results$Q == "Q3e_tree_stand_BA"][2]`). In contrast, we found that leaf litter volume increased by `r signif(q3_litter_vol_sig$litter_vol_diff[1],3)` cm^3^/m^2^ for a 1 m^2^/ha increase in forest quality (i.e. tree stand basal area; LR = `r round(results$test_stat[results$Q == "Q3f_tree_stand_BA"][2],3)`, *P* `r results$pval[results$Q == "Q3f_tree_stand_BA"][2]`; `r results$fig_ref[results$Q == "Q3f_tree_stand_BA"][2]`).

Using thermal images we were able to quantify the thermal diversity and spatial configuration of surface microclimates. Thermal diversity has a bearing on the diversity of organisms that are able to find microclimates meeting their thermal requirements (which vary according to species, age, time of day, seasonality, etc.).  Spatial configuration influences the ease with which organisms can utilise microclimates. We found that the temperature range spanned by surface microclimates (both warm and cool patches) was comparable between logged and primary forests (LR = `r round(results$test_stat[results$Q == "Q3a_forest_type"][2],3)`, *P* `r results$pval[results$Q == "Q3a_forest_type"][2]`; `r results$fig_ref[results$Q == "Q3a_forest_type"][2]`) and with varying forest quality (LR = `r round(results$test_stat[results$Q == "Q3a_tree_stand_BA"][2],3)`, *P* `r results$pval[results$Q == "Q3a_tree_stand_BA"][2]`; `r results$fig_ref[results$Q == "Q3a_tree_stand_BA"][2]`). The same was true for the Aggregation Index of cool surface patches, both between logged and primary forest (`r paste("\U03A7","\U00B2",sep="")` = `r round(results$test_stat[results$Q == "Q3c_forest_type"][1],3)`, *P* `r results$pval[results$Q == "Q3c_forest_type"][1]`; `r results$fig_ref[results$Q == "Q3c_forest_type"][1]`) and with different levels of forest quality (`r paste("\U03A7","\U00B2",sep="")` = `r round(results$test_stat[results$Q == "Q3c_tree_stand_BA"][1],3)`, *P* `r results$pval[results$Q == "Q3c_tree_stand_BA"][1]`; `r results$fig_ref[results$Q == "Q3c_tree_stand_BA"][1]`).

Overall, the availability of microclimates was minimally affected by selective logging, regardless of whether microclimates were located at the surface or inside microhabitats. This was true for various different components of microclimate availability, including their occurrence, thermal diversity and spatial configuration.

```{r fig-4-5}
fig5

```

 The influence of forest type (primary or logged forest) and forest quality (measured as tree stand basal area) on microclimate availability. Results for surface microclimates (top row) include: the temperature range from the warmest warm patch to the coolest cool patch (a); the average surface area of cool patches (b); and the Aggregation Index of cool patches (c). The volume (per m^2^ forest) of microhabitats typically associated with microclimates (bottom row) is shown for deadwood (d), tree holes (e) and leaf litter (f). Primary forest data points are depicted as blue circles and logged forest as orange triangles. Shaded bands represent 95% confidence intervals. Asterisks in panel f denote a statistically significant difference at 0.001 < *P* < 0.01 (\*\*).

## Discussion

Forest degradation by commercial selective logging affects huge expanses of the tropics [@asner_contemporary2009; @lewis_increasing2015]. Southeast Asia has experienced the most intensive selective logging of all tropical rainforests [@lewis_increasing2015], and in our study area ~145 m^3^ of timber was removed per hectare. Despite these forests having only a maximum of 12 years post-logging recovery [@fisher_cost-effective2011], and the coincidental occurrence during data collection of abnormally hot and dry conditions associated with the strongest El Ni&ntilde;o-Southern Oscillation (ENSO) event since 1998 [@noaa2015], we found very few thermal differences associated with selective logging. This is an important finding for tropical conservation because it suggests that the potential for thermal buffering will not limit the ability of selectively logged forests to maintain high biodiversity under climate change. 

### Forest structure

At a local scale (m to ha), climate is highly dependent upon vegetation [@oke_boundary1987; @sears_world2011]. Selective logging operations generally target larger and older trees, leading to many associated changes in vegetation structure [@okuda_effect2003; @kumar_effects2005; @edwards_maintaining2014]. A clear signal of historical logging in our study area was a reduction in stand basal area of mature trees by `r signif(((qs2_tree_stand_BA$tree_stand_BA[1] - qs2_tree_stand_BA$tree_stand_BA[2]) / qs2_tree_stand_BA$tree_stand_BA[1])*100,3)`% [`r results$fig_ref[results$Q == "QS2c_forest_type"][2]`; @berry_impacts2008], accompanied by reduced variation in tree basal area (`r results$fig_ref[results$Q == "QS2e_forest_type"][2]`), and reduced vegetation cover at &ge; 15 m height (Fig. S1h,i). The increase in stand basal area of saplings by `r signif(((qs2_saplingBA$sapling_stand_BA[2] - qs2_saplingBA$sapling_stand_BA[1]) / qs2_saplingBA$sapling_stand_BA[1])*100,3)`% (`r results$fig_ref[results$Q == "QS2d_forest_type"][2]`) is evidence that there has been substantial natural regeneration in the intervening years.

### Macroclimate and microclimate temperature

Although primary forest contained more large trees (`r results$fig_ref[results$Q == "QS2c_forest_type"][2]`), the absence of any long-term effect of selective logging on percentage canopy cover (`r results$fig_ref[results$Q == "QS2h_forest_type"][2]`) suggests that forest vegetation as a whole -- regardless of how it was distributed vertically -- intercepted comparable amounts of incoming solar radiation in both logged and primary forests. This finding is in keeping with previous studies observing rapid horizontal canopy growth following selective logging [e.g. @asner_canopy2004]. Alternatively, vegetation in logged forest may have intercepted less incoming radiation than in primary forest (i.e. if there was less vegetation overall), but reflected a greater proportion of what was intercepted, owing to the higher albedo of habitats with an abundance of non-tree species [@oke_boundary1987; @davin_climatic2010; @edwards_maintaining2014]. In either case (or in combination), given comparable levels of solar radiation reaching the forest floor of logged and primary forests, it follows that the temperature at coarse and fine scales (macroclimate and microclimate temperatures) should also be comparable (Fig. 3 and Fig. S2).

The temperature of cool microclimates relative to average conditions is what largely determines their ability to buffer macroclimate warming [@scheffers_microhabitats2014-1; @gonzalez_del_pliego_thermally2016; @shi_framework2016]. Given that selective logging did not affect absolute temperature of the macroclimate (Fig. S2) or microclimates (Fig. 3), we can infer that there was no overall effect of selective logging on the difference between micro- and macroclimate temperature. There was also no evidence that selective logging impacted overall daily variation in microclimate temperature (Fig. 4). There were some impacts of logging on the relationship between microclimate and macroclimate temperature for microclimates inside deadwood, tree holes and leaf litter (Fig. 3), but the effect sizes for these interactions were extremely small. The maximum difference in microclimate warming between logged and primary forests was < 0.1&deg;C for 1&deg;C of macroclimate warming. As such, we conclude that even when selective logging had a statistically significant influence on thermal buffering potential, the effect was small and of limited biological relevance.

### Microclimate availability

Even if microclimates are present and effective at buffering temperature change, overall rarity or isolation could render them functionally redundant to some species [@sears_world2011; @sears_configuration2016]. We demonstrate that lower forest quality was associated with less leaf litter [Fig. 5; cf. @saner_reduced2009], but forest quality and forest type had little effect on the occurrence of microclimates at the surface or inside deadwood and tree holes. This is contrary to expectations from previous studies [@ball_tree1999; @blakely_tree2008]. However, high volumes of deadwood could be maintained in logged forest by lower decomposition rates [@ewers_logging2015; @yeong_leaf2016; but see @herault_modeling2010], and large remnant pieces from harvest operations. In undisturbed forests, tree holes tend to be associated with larger, older trees [@lindenmayer_cavity2000; @blakely_tree2008]. A comparable quantity of tree holes might be found in logged forests because of damage from logging operations [@edwards_maintaining2014], increased wind in gaps [@chen_growing-season1995] and remnant large trees that were specifically avoided by logging companies because of hollow boles. Additionally, we assessed tree holes in the understorey only, and differences may well manifest at higher forest strata.

The availability of microclimates to organisms is also influenced by their thermal diversity and distribution in space. We found that patches of warm and cool microclimates on the surface of the forest floor spanned a temperature range of about `r round(median(q3_patch_range$patch.range),0)`&deg;C, regardless of logging activity (`r results$fig_ref[results$Q == "Q3a_tree_stand_BA"][2]`). Cool patches were generally highly clustered in space (Aggregation Index of `r signif(q3_patch_AI$cold.patch.AI[1]*100,3)`%), but this was not affected by logging (`r results$fig_ref[results$Q == "Q3c_tree_stand_BA"][2]`). Thermal diversity and spatial configuration of microclimates are relatively novel facets of thermal buffering potential [but see: @caillon_warming2014; @sears_configuration2016; @faye_toolbox2016]; they are likely determined by the composition of the forest floor and the relative radiative properties of these different components [e.g. bare soil versus leaves versus water; @oke_boundary1987; @snyder_analyzing2004]. We therefore suggest that these characteristics of the forest floor were comparable between forests despite the large differences in forest structure that were evident after logging.

### Caveats and future research directions

The potential for thermal buffering and its general necessity are influenced by moisture levels, as well as temperature [@mclaughlin_hydrologic2017]. Many ectotherms, including amphibians [@duellman_biology1986] and isopods [@hassall_predicting2010], can survive in hot temperatures for longer if relative humidity is sufficiently high to prevent desiccation. Although we did not measure fine-scale vapour pressure deficit (a variable combining both temperature and relative humidity), we did find that coarse-scale vapour pressure deficit measurements from the hygrometer and from hygrochron iButtons (Supplementary Text S4) showed little variation within or between forests (Fig. S2). 

Relative climates in primary and logged forests could be very different above the understorey, which we were unable to capture in our study. Some ectotherms move down from the upper strata to exploit more favourable temperatures lower down [@scheffers_increasing2013]. Hence, if temperatures in higher strata are in fact hotter in logged forest compared to primary forest, it is possible that species could move to utilise the favourable temperatures of the understorey of logged forest that we  demonstrate here, potentially resulting in a 'flattening' of species' vertical distributions.

While thermal cameras are an important addition to the toolbox of microclimate research [@faye_toolbox2016], it is also important to remember that they are just one element. Thermal cameras are well-suited to capturing temperature at a very fine-scale and with inherent spatial information, but differences in 3D topography of a surface could affect results (e.g. the real distance between neighbouring pixels can be more than is apparent in the 2D image). Additionally, although thermal cameras are ideal for measuring surface temperatures, they have a limited capacity to capture sub-surface temperatures, and hence we have used thermal imagery in combination with dataloggers.

The ability of selectively logged tropical forests to retain current levels of biodiversity will critically depend on their ability to protect species from the impacts of increasingly severe climate change. As average temperatures increase over this century, so too will the intensity and frequency of extreme climatic events. Thermal buffering will likely be crucial in allowing species to move locally to avoid suboptimal climates. We sampled in some of the most intensively logged forest in the tropics, during abnormally hot and dry conditions of a severe ENSO event; it is highly unlikely that our study would have failed to detect any appreciable thermal differences between primary and logged forests had they existed. Regardless of whether commercially selectively logged forests remain biologically or structurally distinctive from undisturbed forests, this study shows for the first time that they are functionally equivalent in the provisioning of cool microclimates, and underscores their vital role in conservation both now and under future climate warming.

## Acknowledgements
Thanks to staff at Danum Valley Field Centre for logistical support; and Azlin Bin Sailim, Jessica Olid and Chloe Walker-Trivett for field assistance. R.A.S. was funded by a NERC studentship through the ACCE (Adapting to the Challenges of a Changing Environment) Doctoral Training Partnership (Grant No. NE/L002450/1).

## Data availability

Data available from the University of Sheffield Online Research Data repository (DOI: 10.15131/shef.data.5414629).














